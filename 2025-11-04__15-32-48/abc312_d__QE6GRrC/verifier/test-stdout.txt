
======== SOLUTION.PY CONTENT ========
def solve():
    MOD = 998244353
    s = input().strip()
    n = len(s)

    # dp[i][balance] = number of ways to reach position i with given balance
    # balance = count of '(' - count of ')'
    # balance must be >= 0 at all times and = 0 at the end

    # Maximum possible balance is n (all opening brackets)
    dp = [[0] * (n + 1) for _ in range(n + 1)]
    dp[0][0] = 1  # Base case: at position 0 with balance 0

    for i in range(n):
        for balance in range(n + 1):
            if dp[i][balance] == 0:
                continue

            char = s[i]

            if char == '(':
                # Opening bracket increases balance
                if balance + 1 <= n:
                    dp[i + 1][balance + 1] = (dp[i + 1][balance + 1] + dp[i][balance]) % MOD
            elif char == ')':
                # Closing bracket decreases balance
                # Only valid if balance > 0 (can't close more than opened)
                if balance > 0:
                    dp[i + 1][balance - 1] = (dp[i + 1][balance - 1] + dp[i][balance]) % MOD
            else:  # char == '?'
                # Can be either ( or )
                # Try as opening bracket
                if balance + 1 <= n:
                    dp[i + 1][balance + 1] = (dp[i + 1][balance + 1] + dp[i][balance]) % MOD
                # Try as closing bracket
                if balance > 0:
                    dp[i + 1][balance - 1] = (dp[i + 1][balance - 1] + dp[i][balance]) % MOD

    # Answer is the number of ways to reach the end with balance = 0
    print(dp[n][0])

solve()

======== END OF SOLUTION.PY CONTENT ========

Input: (???(?

(stdin test) PASSED public_test_1 (test time: 0.01s)
Input: )))))

(stdin test) PASSED public_test_2 (test time: 0.02s)
Input: ??????????????(????????(??????)?????????(?(??)

(stdin test) PASSED public_test_3 (test time: 0.01s)
Input: ?

(stdin test) PASSED private_test_1 (test time: 0.01s)
Input: ??

(stdin test) PASSED private_test_2 (test time: 0.01s)
Input: ?)

(stdin test) PASSED private_test_3 (test time: 0.02s)
Input: ?(?(((((?(?(?(((((?((??((((?(?(((((((?((???((??((((((((((??((??(?((()?(((?((((((((?((?(?((((((((((?(...
(stdin test) PASSED private_test_4 (test time: 0.18s)
Input: ????????????????????????????????????????????????????????????????????????????????????????????????????...
(stdin test) PASSED private_test_5 (test time: 0.35s)
Input: ((???(????((?((((?((???????????(????(?(?(??(((????((?((?((???(???(????(???(??(?((??(????(?(?????(?(?...
(stdin test) PASSED private_test_6 (test time: 0.29s)
Input: (((?((((((((?((((((?((((((?(((?((??((((?(?(((((?((((??((((()?)((((((((((((((((?((((()((?)((()()(((((...
(stdin test) PASSED private_test_7 (test time: 0.19s)
Input: ?((((((((((?(((((((((((((((((((((?(((?((((((((((((((((((((((((((((?()(((((?((()((((((((()(((?((?((((...
(stdin test) PASSED private_test_8 (test time: 0.20s)
Input: ????(??????????????(????(??????(?(?????????????(?????????????(??????(?(??????????????(?(?(??????????...
(stdin test) PASSED private_test_9 (test time: 0.86s)
Input: ????((?????((((??(??((??((?(????(????(?????(????((?((???(??(?(??(?????((?((((??(?(?(??)????(?((??(?(...
(stdin test) PASSED private_test_10 (test time: 0.77s)
Input: ??((((((?(((?(??((?(?((?(((??((((?(??(((((?((?(((?(?(((??(((?()?(?(((((?((?((((?(??(((((((((((((?(?(...
(stdin test) PASSED private_test_11 (test time: 0.65s)
Input: ((??(?(?((?((((((((((((?(((??((((?(((((((((((?(((((?(?((??(((?((((?((((((((((?((((()(??(((?(???(((((...
(stdin test) PASSED private_test_12 (test time: 0.53s)
=========================== short test summary info ============================
PASSED public_test_1
PASSED public_test_2
PASSED public_test_3
PASSED private_test_1
PASSED private_test_2
PASSED private_test_3
PASSED private_test_4
PASSED private_test_5
PASSED private_test_6
PASSED private_test_7
PASSED private_test_8
PASSED private_test_9
PASSED private_test_10
PASSED private_test_11
PASSED private_test_12
=========================== 15 passed in 0.01s ===========================

ðŸŽ‰ TASK PASSED: All 15 tests passed!
